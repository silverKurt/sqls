WITH
MEMBER [Measures].[Faturado] AS
    [Measures].[vlrtotalfatura], format_string = Iif(((([FaixadeFrequencia].CurrentMember.Name = "F5 - MAIS QUE 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS")), "|R$ #,##0.00|customCss=background-color:\#52AEBB", iif(((((([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS"))) OR ((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS"))), "|R$ #,##0.00|customCss=background-color:\#2DB962", iif((([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")), "|R$ #,##0.00|customCss=background-color:\#88B92D", iif((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")), "|R$ #,##0.00|customCss=background-color:\#4A892B", iif((((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") OR ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")) AND ([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS")) OR ((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") OR ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")) AND ([FaixadeFrequencia].CurrentMember.Name = "F5 - MAIS QUE 100 COMPRAS"))), "|R$ #,##0.00|customCss=background-color:\#A1DCE8", iif((([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")), "|R$ #,##0.00|customCss=background-color:\#DFEEF1", iif(((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")), "|R$ #,##0.00|customCss=background-color:\#8EB24F", iif((((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R2 - DE 181 A 270 DIAS")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R1 - INATIVO"))), "|R$ #,##0.00|style=yellow", iif((((([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R1 - INATIVO")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R2 - DE 181 A 270 DIAS"))), "|R$ #,##0.00|customCss=background-color:\#EEA12B", "|R$ #,##0.00|customCss=background-color:\#EE2B2B")))))))))
MEMBER [Measures].[Clientes] AS
    [Measures].[qtdclientes], format_string = Iif(((([FaixadeFrequencia].CurrentMember.Name = "F5 - MAIS QUE 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS")), "|0|customCss=background-color:\#52AEBB", iif(((((([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS"))) OR ((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS"))), "|0|customCss=background-color:\#2DB962", iif((([FaixadeRecencia].CurrentMember.Name = "R5 - ATÉ 60 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")), "|0|customCss=background-color:\#88B92D", iif((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")), "|0|customCss=background-color:\#4A892B", iif((((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") OR ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")) AND ([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS")) OR ((([FaixadeRecencia].CurrentMember.Name = "R4 - DE 61 A 120 DIAS") OR ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")) AND ([FaixadeFrequencia].CurrentMember.Name = "F5 - MAIS QUE 100 COMPRAS"))), "|0|customCss=background-color:\#A1DCE8", iif((([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS") AND ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")), "|0|customCss=background-color:\#DFEEF1", iif(((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R3 - DE 121 A 180 DIAS")), "|0|customCss=background-color:\#8EB24F", iif((((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R2 - DE 181 A 270 DIAS")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F2 - ENTRE 11 E 30 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F1 - ATÉ 10 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R1 - INATIVO"))), "|0|style=yellow", iif((((([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R1 - INATIVO")) OR ((([FaixadeFrequencia].CurrentMember.Name = "F4 - ENTRE 51 E 100 COMPRAS") OR ([FaixadeFrequencia].CurrentMember.Name = "F3 - ENTRE 31 E 50 COMPRAS")) AND ([FaixadeRecencia].CurrentMember.Name = "R2 - DE 181 A 270 DIAS"))), "|0|customCss=background-color:\#EEA12B", "|0|customCss=background-color:\#EE2B2B")))))))))
SELECT
NON EMPTY {[FaixadeRecencia].[R1 - INATIVO], [FaixadeRecencia].[R2 - DE 181 A 270 DIAS], [FaixadeRecencia].[R3 - DE 121 A 180 DIAS], [FaixadeRecencia].[R4 - DE 61 A 120 DIAS], [FaixadeRecencia].[R5 - ATÉ 60 DIAS]} ON COLUMNS,
NON EMPTY NonEmptyCrossJoin({[FaixadeFrequencia].[F1 - ATÉ 10 COMPRAS], [FaixadeFrequencia].[F2 - ENTRE 11 E 30 COMPRAS], [FaixadeFrequencia].[F3 - ENTRE 31 E 50 COMPRAS], [FaixadeFrequencia].[F4 - ENTRE 51 E 100 COMPRAS], [FaixadeFrequencia].[F5 - MAIS QUE 100 COMPRAS]}, {[Measures].[Clientes], [Measures].[Faturado]}) ON ROWS
FROM [FaturamentoDiarizacao]